<!DOCTYPE html>
<html lang="en">
<head>
    <title>Visualifico - MongoDB Visual Analytics Middleware</title>

    <meta charset="UTF-8">
	<link  rel="stylesheet" type="text/css" href="stylesheets/style.css">
	<link  rel="stylesheet" type="text/css" href="stylesheets/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="stylesheets/visualifico-chart.css"/>
	
	
	<script type="text/javascript" src="javascript/melt.js"></script>
	
	
	<script src="javascript/d3.min.js" charset="utf-8"></script>
	<script type="text/javascript" src="javascript/crossfilter.js"></script>
	<script type="text/javascript" src="javascript/visualifico.js"></script>
    <style>
        
    </style>
</head>
<body>
	<div class="main-container">
	
		<div id="chart-brands-items-by-day"></div>
		<div id="chart-prices-by-brands"></div>
		<div id="chart-items-by-day"></div>
		
	</div>
<script>
	
	var event_dispatcher = new EventDispatcher ();
	
	var vbc = new VerticalCategoryBarChart ();

	vbc.init (
		
		"chart-prices-by-brands",
		//get_value
		function (d) {
		
			return d.TotalNew;
		},
		//get_key
		function (d) {
			
			return d.Brand;
		},
		event_dispatcher,
		{ 
			"height": 350, 
			"width": 800,
			"collection": "bestSellersItems", 
			"dimension": "Brand", 
			"measure": "TotalNew",
			"useCategoryColors":true,
			"defaultFilters": {"When":{"$in":["2014-12-26","2014-12-27","2014-12-28","2014-12-29","2014-12-30"]},"Brand":{"$in":["LAMPA","Bosch","TomTom","Garmin"]}}
		}
	);
	
	event_dispatcher.addListener (vbc);
		
	vbc.loadData ({"top": 10}, 
	
		function (feedback) {	
		
			vbc.draw();
		}
	);	
	
	
	var hbc = new HorizontalCategoryBarChart ();

	hbc.init (
		
		"chart-items-by-day",
		//get_value
		function (d) {
		
			return d.TotalNew;
		},
		//get_key
		function (d) {
			
			return d.When;
		},
		event_dispatcher,
		{ 	
			"height": 200, 
			"width": 800,
			"collection": "bestSellersItems", 
			"dimension": "When", 
			"measure": "TotalNew",
			"defaultColor":"rgb(119, 147, 60)",
			"defaultFilters": {"When":{"$in":["2014-12-26","2014-12-27","2014-12-28","2014-12-29","2014-12-30"]},"Brand":{"$in":["LAMPA","Bosch","TomTom","Garmin"]}}
		}
	);
	
	event_dispatcher.addListener (hbc);
	
	hbc.loadData ({}, function (feedback) {	
	
		hbc.draw();
	});	
	
	var sbc = new StackedBarChart ();

	sbc.init (		
		"chart-brands-items-by-day",
		//get_value
		function (d) {
			console.log (JSON.stringify(d));
			return d.TotalNew;
		},
		//get_key
		function (d) {
			
			return d.key [0];
		},
		//get_stacked_key
		function (d) {
			
			return d.key [1];
		},
		event_dispatcher,
		{ 	
			"height": 400, 
			"width": 800,
			"collection": "bestSellersItems", 
			"dimension": "When", 
			"stackedDimension": "Brand", 
			"measure": "TotalNew",
			"useCategoryColors":true,
			"defaultFilters": {"Brand":{"$in":["LAMPA","Bosch","TomTom","Garmin"]}}
		}
	);
	
	event_dispatcher.addListener (sbc);
	
	sbc.loadData ({}, function (feedback) {	
	
		sbc.draw();
	});	
	
</script>
</body>
</html>
